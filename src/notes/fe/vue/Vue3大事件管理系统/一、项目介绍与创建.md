---
title: ä¸€ã€é¡¹ç›®ä»‹ç»ä¸åˆ›å»º
order: 1
---

# ä¸€ã€é¡¹ç›®ä»‹ç»ä¸åˆ›å»º

[åœ¨çº¿æ¼”ç¤º](https://fe-bigevent-web.itheima.net/login)

[æ¥å£æ–‡æ¡£](https://apifox.com/apidoc/shared-26c67aee-0233-4d23-aab7-08448fdf95ff/api-93850835)


## æœ¬é¡¹ç›®æŠ€æœ¯æ ˆ

ES6ã€Vue3ã€Piniaã€Vue-Routerã€Viteã€Axiosã€ElementPlus

## åˆ›å»ºé¡¹ç›®

ä½¿ç”¨ pnpm åŒ…ç®¡ç†å™¨

![image-20231031150329877](md_img/image-20231031150329877.png)

1. å®‰è£…æ–¹å¼ï¼š

```bash
npm install -g pnpm
```

2. åˆ›å»ºé¡¹ç›®ï¼š

```bash
pnpm create vue
```

![image-20231031150957747](md_img/image-20231031150957747.png)

3. å®‰è£…ä¾èµ–ï¼š

```bash
pnpm install
```

4. è¿è¡Œ

```bash
pnpm dev
```

## é…ç½®ä»£ç é£æ ¼

ä¸»è¦ä½¿ç”¨ ESLint å’Œ Prettier

+ ESLint ä¸»è¦æ˜¯è§„èŒƒä»£ç 

+ Prettier ä¸»è¦æ˜¯ç¾åŒ–ä»£ç é£æ ¼

### ç¯å¢ƒåŒæ­¥

1. å®‰è£…äº†æ’ä»¶ ESLintï¼Œå¼€å¯ä¿å­˜è‡ªåŠ¨ä¿®å¤
   
2. ç¦ç”¨æ’ä»¶ Prettierï¼Œå…³é—­ä¿å­˜è‡ªåŠ¨æ ¼å¼åŒ–

```json
// vscodeä¸‹é¢çš„setting.json

// ESlintæ’ä»¶ + Vscodeé…ç½® å®ç°è‡ªåŠ¨æ ¼å¼åŒ–ä¿®å¤
"editor.codeActionsOnSave": {
    "source.fixAll": true
},
"editor.formatOnSave": false,
```

### é…ç½®æ–‡ä»¶ .eslintrc.cjs

1. prettier é£æ ¼é…ç½®

   1. å•å¼•å·

   2. ä¸ä½¿ç”¨åˆ†å·

   3. æ¯è¡Œå®½åº¦è‡³å¤š80å­—ç¬¦

   4. ä¸åŠ å¯¹è±¡|æ•°ç»„æœ€åé€—å·

   5. æ¢è¡Œç¬¦å·ä¸é™åˆ¶ï¼ˆwin mac ä¸ä¸€è‡´ï¼‰

2. vue ç»„ä»¶åç§°å¤šå•è¯ç»„æˆï¼ˆå¿½ç•¥index.vueï¼‰

3. props è§£æ„ï¼ˆå…³é—­ï¼‰

```jsx
// .eslintrc.cjs

rules: {
  'prettier/prettier': [
    'warn',
    {
      singleQuote: true, // å•å¼•å·
      semi: false, // æ— åˆ†å·
      printWidth: 80, // æ¯è¡Œå®½åº¦è‡³å¤š80å­—ç¬¦
      trailingComma: 'none', // ä¸åŠ å¯¹è±¡|æ•°ç»„æœ€åé€—å·
      endOfLine: 'auto' // æ¢è¡Œç¬¦å·ä¸é™åˆ¶ï¼ˆwin mac ä¸ä¸€è‡´ï¼‰
    }
  ],
  'vue/multi-word-component-names': [
    'warn',
    {
      ignores: ['index'] // vueç»„ä»¶åç§°å¤šå•è¯ç»„æˆï¼ˆå¿½ç•¥index.vueï¼‰
    }
  ],
  'vue/no-setup-props-destructure': ['off'], // å…³é—­ props è§£æ„çš„æ ¡éªŒ
  // ğŸ’¡ æ·»åŠ æœªå®šä¹‰å˜é‡é”™è¯¯æç¤ºï¼Œcreate-vue@3.6.3 å…³é—­ï¼Œè¿™é‡ŒåŠ ä¸Šæ˜¯ä¸ºäº†æ”¯æŒä¸‹ä¸€ä¸ªç« èŠ‚æ¼”ç¤ºã€‚
  'no-undef': 'error'
}
```

### é…ç½® husky ä»£ç æ£€æŸ¥å·¥ä½œæµ

husky æ˜¯ä¸€ä¸ª git hooks å·¥å…·ï¼Œèƒ½åœ¨æäº¤ä»£ç å‰åšæ£€æŸ¥

1. åˆå§‹åŒ– git ä»“åº“

```bash
git init
```

2. åˆå§‹åŒ– husky å·¥å…·é…ç½®

```bash
pnpm dlx husky-init && pnpm install
```

3. æ›´æ”¹é…ç½®

```jsx
// .husky/pre-commit

// npm test
pnpm lint
```

è¿™æ ·å°±å¯ä»¥å¯¹æ•´ä¸ªå·¥ç¨‹æ–‡ä»¶è¿›è¡Œ **å…¨é‡æ£€æŸ¥**

æ˜¯çš„ï¼Œå®ƒä¼šæŠŠæ‰€æœ‰æ–‡ä»¶éƒ½æ‰«ä¸€éï¼Œè¿™æ ·å°±ä¼šé€ æˆæ•´ä¸ªé¡¹ç›®ä¼šéå¸¸è€—æ—¶ï¼Œä¸”åˆ«äººçœ‹åˆ°è¿™ä»£ç çš„æ—¶å€™ä¼šå¾ˆæ··ä¹±ã€‚

è§£å†³è¿™ä¸ªé—®é¢˜å…¶å®ä¹Ÿä¸éš¾ï¼Œä½¿ç”¨æš‚å­˜åŒºå°±å¯ä»¥äº†

#### æš‚å­˜åŒº eslint æ ¡éªŒ

å½“ä»£ç å†™åˆ°ä¸€éƒ¨åˆ†çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆæäº¤åˆ°æš‚å­˜åŒºï¼Œæš‚å­˜åŒºä¹‹åå†æäº¤åˆ°ä»“åº“ã€‚

1. å®‰è£… lint-staged åŒ…

```bash
pnpm i lint-staged -D
```

2. `package.json` é…ç½® `lint-staged` å‘½ä»¤

```json
// package.json

{
  "scripts": {
    ...,
    "lint-staged": "lint-staged"
  },
  "devDependencies":{
  	...
	},
  "lint-staged": {
    "*.{js,ts,vue}": [
      "eslint --fix"
    ]
  }
}
```

3. `.husky/pre-commit` æ–‡ä»¶ä¿®æ”¹

```jsx
// .husky/pre-commit

// pnpm lint
pnpm lint-staged
```

è¿™æ ·çš„è¯ï¼Œæ¯å½“æˆ‘ä»¬ä¿®æ”¹æŸä¸€æ®µä»£ç ï¼Œå®ƒåªä¼šå¯¹æŸä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ ¡éªŒ

## è°ƒæ•´ç›®å½•

```txt
src
â”œâ”€â”€ api(æ–°å¢)
â”œâ”€â”€ assets
â”‚   â””â”€â”€ .(åˆ é™¤)
â”‚   â”œâ”€â”€ avatar.jpg(æ–°å¢)
â”‚   â”œâ”€â”€ cover.jpg(æ–°å¢)
â”‚   â”œâ”€â”€ default.png(æ–°å¢)
â”‚   â”œâ”€â”€ login_bg.jpg(æ–°å¢)
â”‚   â”œâ”€â”€ login_title.jpg(æ–°å¢)
â”‚   â”œâ”€â”€ logo.png(æ–°å¢)
â”‚   â”œâ”€â”€ logo2.png(æ–°å¢)
â”‚   â””â”€â”€ main.scss(æ–°å¢)
â”œâ”€â”€ components
â”‚   â””â”€â”€ .(åˆ é™¤)
â”œâ”€â”€ router
â”‚   â””â”€â”€ index.js(ä¿®æ”¹)
â”œâ”€â”€ stores
â”‚   â””â”€â”€ .(åˆ é™¤)
â”œâ”€â”€ utils(æ–°å¢)
â”œâ”€â”€ views
â”‚   â””â”€â”€ .(åˆ é™¤)
â”œâ”€â”€ App.vue(ä¿®æ”¹)
â””â”€â”€ main.js
```

+ `src/api/` å­˜æ”¾è¯·æ±‚å‡½æ•°
+ `src/assets/` å­˜æ”¾é™æ€èµ„æº
+ `src/components/` å­˜æ”¾å…¬å…±ç»„ä»¶
+ `src/router/` å­˜æ”¾è·¯ç”±
+ `src/stores/` å­˜æ”¾ä»“åº“æ¨¡å—ï¼Œéœ€è¦åœ¨é¡µé¢å¼•ç”¨æ‰ä¼šåˆå§‹åŒ–
+ `src/utils/` å­˜æ”¾è‡ªå·±å°è£…çš„å·¥å…·å‡½æ•°

```javascript
// src/router/index.js

import { createRouter, createWebHistory } from 'vue-router'

const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL),
  routes: []
})

export default router
```

```vue
// src/App.vue

<template>
  <div>
    <router-view></router-view>
  </div>
</template>

<style scoped></style>
```

```javascript
// src/main.js

import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'
import router from './router'
import '@/assets/main.scss'

const app = createApp(App)

app.use(createPinia())
app.use(router)
app.mount('#app')
```

å®‰è£… sass ä¾èµ–

```bash
pnpm add sass -D
```

## VueRouter4 è·¯ç”±ä»£ç è§£æ

```javascript
// src/router/index.js

// æŒ‰éœ€å¯¼å…¥
import { createRouter, createWebHistory } from 'vue-router'

// createRouter åˆ›å»ºè·¯ç”±å®ä¾‹ï¼Œ===> new VueRouter()
const router = createRouter({
  // é…ç½®æ¨¡å¼
  // 1. historyæ¨¡å¼: createWebHistory()   http://xxx/user
	// 2. hashæ¨¡å¼: createWebHashHistory()  http://xxx/#/user
  
  // import.meta.env.BASE_URL æ˜¯è·¯ç”±çš„åŸºå‡†åœ°å€ï¼ŒåŠ äº†ä»€ä¹ˆå‰é¢å°±é»˜è®¤æœ‰ä»€ä¹ˆï¼Œé»˜è®¤æ˜¯ '/'ï¼Œå¯ä»¥åœ¨ vite.config.ts ç»Ÿä¸€é…ç½® base: my-pathï¼Œè·¯ç”±è¿™å°±ä¼šåŠ ä¸Š my-path å‰ç¼€äº†
  history: createWebHistory(import.meta.env.BASE_URL),
  // é…è·¯ç”±è§„åˆ™
  routes: []
})

export default router
```

å…¶ä¸­ï¼Œ`import.meta.env.BASE_URL` æ˜¯Vite ç¯å¢ƒå˜é‡ï¼Œå…·ä½“çœ‹[è¿™é‡Œ](https://cn.vitejs.dev/guide/env-and-mode.html)

å…¶å® `hash` æ¨¡å¼çš„åœ°å€ä¸­é—´æœ‰ #ï¼Œè€Œ `history` æ¨¡å¼ä¸­é—´æ²¡æœ‰ #

ä¸€èˆ¬ä½¿ç”¨ `history` æ¨¡å¼

## å¼•å…¥ ElementUI ç»„ä»¶åº“

[å®˜æ–¹æ–‡æ¡£](https://element-plus.org/zh-CN/)

1. å®‰è£…ç»„ä»¶åº“

```bash
pnpm add element-plus
```

2. æŒ‰éœ€å¯¼å…¥ï¼Œå®‰è£…æ’ä»¶

```bash
pnpm add -D unplugin-vue-components unplugin-auto-import
```

3. é…ç½®æ–‡ä»¶å®ç°è‡ªåŠ¨å¯¼å…¥

```javascript
// vite.config.js

...
import AutoImport from 'unplugin-auto-import/vite'
import Components from 'unplugin-vue-components/vite'
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers'

export default defineConfig({
  plugins: [
    ...
    AutoImport({
      resolvers: [ElementPlusResolver()]
    }),
    Components({
      resolvers: [ElementPlusResolver()]
    })
  ]
})
```

## Pinia - æ„å»ºç”¨æˆ·ä»“åº“ å’Œ æŒä¹…åŒ–

[å®˜æ–¹æ–‡æ¡£](https://prazdevs.github.io/pinia-plugin-persistedstate/zh/)

### æ„å»ºç”¨æˆ·ä»“åº“

```javascript
// src/stores/user.js

import { defineStore } from 'pinia'
import { ref } from 'vue'

export const useUserStore = defineStore('big-user', () => {
  const token = ref('')
  const setToken = (newToken) => {
    token.value = newToken
  }
  const removeToken = () => {
    token.value = ''
  }
  
  return {
    token,
    setToken,
    removeToken
  }
})
```

```vue
// src/App.vue

<srcipt setup>
import { useUserStore } from '@/stores/user'

const userStore = useUserStore()
</srcipt> 

<template>
	<div>
    <p>{{ useUserStore.token }}</p>
    <el-button @click="userStore.setToken('Bearer ...')">ç™»å½•</el-button>
    <el-button @click="userStore.removeToken()">é€€å‡º</el-button>
  </div>
</template>
```

![image-20231101103642096](md_img/image-20231101103642096.png)

ç°åœ¨ï¼Œä»“åº“æ„å»ºå®Œæˆ

ä½†æ˜¯ï¼Œå¦‚æœä¸€åˆ·æ–°é¡µé¢ï¼Œä½ ä¼šå‘ç°ç™»å½•çš„ä¿¡æ¯åˆæ²¡æœ‰äº†ï¼Œé‚£æ˜¯å› ä¸ºæ²¡æœ‰åšæŒä¹…åŒ–çš„åŸå› ï¼Œæˆ‘ä»¬åªéœ€è¦åŠ ä¸Šä¸€äº›ä¸œè¥¿å°±å¯ä»¥æŒä¹…åŒ–å•¦~

1. å®‰è£…æ’ä»¶

```bash
pnpm add pinia-plugin-persistedstate -D
```

2. ä½¿ç”¨ main.js

```javascript
// main.js

import persist from 'pinia-plugin-persistedstate'
...
app.use(createPinia().use(persist))
```

3. é…ç½®æ–‡ä»¶

```javascript
// src/stores/user.js

export const useUserStore = defineStore({
  ...
}, {
  persist: true // æŒä¹…åŒ–
})
```

è¿™æ ·æ“ä½œä»¥åï¼Œå°±å®Œæˆäº†æŒä¹…åŒ–çš„æ“ä½œå•¦~ :smile:

### ç»Ÿä¸€ç®¡ç†

å½“ç„¶ï¼Œä¸ºäº†æœªæ¥èƒ½å¤Ÿæ›´å¥½çš„ç»´æŠ¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ”¹è¿›ä¸€ä¸‹ä»£ç æ¥é¿å… main.js è¿‡äºè‡ƒè‚¿

```javascript
// src/stores/index.js

import { createPinia } from 'pinia'
import persist from 'pinia-plugin-persistedstate'

const pinia = createPinia()
pinia.use(persist)

export default pinia
```

```javascript
// src/main.js

// import { createPinia } from 'pinia'
// import persist from 'pinia-plugin-persistedstate'
import pinia from '@/stores/index'
```

## Axios æ•°æ®äº¤äº’ - è¯·æ±‚å·¥å…·è®¾è®¡

![image-20231101111153658](md_img/image-20231101111153658.png)

ä¸€èˆ¬éœ€è¦ä½¿ç”¨ axios æ¥è¯·æ±‚åç«¯æ¥å£ï¼Œä¸€èˆ¬ä¼šå¯¹ axios è¿›è¡Œä¸€äº›é…ç½®

1. å®‰è£… axios

```bash
pnpm add axios
```

2. å°è£… axios æ¨¡å—

```javascript
// src/utils/request.js

import axios from 'axios'
import { useUserStore } from '@/stores'
import { ElMessage } from 'element-plus'

const baseURL = 'http://big-event-vue-api-t.itheima.net'

const instance = axios.create({
  // TODO 1. åŸºç¡€åœ°å€ï¼Œè¶…æ—¶æ—¶é—´
  baseURL,
  timeout: 10000 // 10ç§’
})

// è¯·æ±‚æ‹¦æˆªå™¨
instance.interceptors.request.use(
  (config) => {
    // TODO 2. æºå¸¦token
    const useStore = useUserStore()
    if (useStore.token) {
      config.headers.Authorization = useStore.token
    }
    return config
  },
  (err) => Promise.reject(err)
)

// å“åº”æ‹¦æˆªå™¨
instance.interceptors.response.use(
  (res) => {
    // TODO 3. å¤„ç†ä¸šåŠ¡å¤±è´¥
    // TODO 4. æ‘˜å–æ ¸å¿ƒå“åº”æ•°æ®
    if (res.data.code === 0) {
      return res
    }
    // å¤„ç†ä¸šåŠ¡å¤±è´¥ï¼Œç»™é”™è¯¯æç¤ºï¼ŒæŠ›å‡ºé”™è¯¯
    ElMessage.error(res.data.message || 'æœåŠ¡å¼‚å¸¸ ')
    return Promise.reject(res.data)
  },
  (err) => {
    // TODO 5. å¤„ç†401é”™è¯¯
    if (err.response?.status === 401) {
      router.push('/login')
    }
    // é”™è¯¯çš„é»˜è®¤æƒ…å†µ
    ElMessage.error(err.response.data.message || 'æœåŠ¡å¼‚å¸¸')
    return Promise.reject(err)
  }
)

export default instance
export { baseURL }
```

## æ•´ä½“è·¯ç”±è®¾è®¡

è·¯ç”±çš„è®¾è®¡å…¶å®å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªé¡¹ç›®çš„æ¡†æ¶ï¼Œæ­å»ºå¥½è·¯ç”±èƒ½å¤Ÿè®©ä½ æ›´åŠ æ¸…æ¥šä»€ä¹ˆé¡µé¢åŠ åœ¨ä»€ä¹ˆä½ç½®ï¼Œéœ€è¦åšä»€ä¹ˆé¡µé¢

**çº¦å®šè·¯ç”±è§„åˆ™**

```txt
src
â”œâ”€â”€ views
â”‚   â””â”€â”€ article
â”‚   â”‚   â”œâ”€â”€ ArticleManage.vue
â”‚   â”‚   â””â”€â”€ ArticleChannel.vue
â”‚   â”œâ”€â”€ layout
â”‚   â”‚   â””â”€â”€ LayoutContainer.vue
â”‚   â”œâ”€â”€ login
â”‚   â”‚   â””â”€â”€ LoginPage.vue
â”‚   â”œâ”€â”€ user
â”‚   â”‚   â”œâ”€â”€ UserProfile.vue
â”‚   â”‚   â”œâ”€â”€ UserAvatar.vue
â””â”€â”€ â””â”€â”€ â””â”€â”€ UserPassword.vue
```

æ–‡ä»¶                        | åŠŸèƒ½      | ç»„ä»¶å          | è·¯ç”±çº§åˆ« |
---------------------------| --------- | --------------- | -------- |
login/LoginPage.vue        | ç™»å½•&æ³¨å†Œ | LoginPage       | ä¸€çº§è·¯ç”± |
layout/LayoutContainer.vue | å¸ƒå±€æ¶å­  | LayoutContainer | ä¸€çº§è·¯ç”± |
article/ArticleManage.vue  | æ–‡ç« ç®¡ç†  | ArticleManage   | äºŒçº§è·¯ç”± |
article/ArticleChannel.vue | é¢‘é“ç®¡ç†  | ArticleChannel  | äºŒçº§è·¯ç”± |
user/UserProfile.vue       | ä¸ªäººè¯¦æƒ…  | UserProfile     | äºŒçº§è·¯ç”± |
user/UserAvatar.vue        | æ›´æ¢å¤´åƒ  | UserAvatar      | äºŒçº§è·¯ç”± |
user/UserPassword.vue      | é‡ç½®å¯†ç   | UserPassword    | äºŒçº§è·¯ç”± |

æ˜ç¡®ä»¥åï¼Œå°±å¯ä»¥å» `router` ä¸‹é¢é…è§„åˆ™äº†

```javascript
// src/router/index.js

const router = createRouter({
  routes: [
    { path: '/login', component: () => import('@/views/login/LoginPage.vue') },
    {
      path: '/',
      component: () => import('@/views/layout/LayoutContainer.vue'),
      redirect: '/article/manage',
      children: [
        {
          path: '/article/manage',
          component: () => import('@/views/article/ArticleManage.vue')
        },
        {
          path: '/article/channel',
          component: () => import('@/views/article/ArticleChannel.vue')
        },
        {
          path: '/user/profile',
          component: () => import('@/views/user/UserProfile.vue')
        },
        {
          path: '/user/avatar',
          component: () => import('@/views/user/UserAvatar.vue')
        },
        {
          path: '/user/password',
          component: () => import('@/views/user/UserPassword.vue')
        }
      ]
    }
  ]
})
```

ç„¶åå»åˆ° `App.vue` åŠ è½½è¿™äº›è·¯ç”±ç•Œé¢

```vue
// src/App.vue

<template>
	<div>
    <router-view></router-view>
  </div>
</template>
```

