import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,e as t}from"./app-dieZJCkT.js";const p="data:image/png;base64,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",e="/Blog/assets/image-20231219103451184-WfxHC9sg.png",o="/Blog/assets/image-20231219120133869-XARtdwpl.png",c="/Blog/assets/image-20231219121318664-wTB--CjP.png",i="/Blog/assets/image-20231219144807181-axncrkUa.png",l={},u=t(`<h1 id="三、ajax原理" tabindex="-1"><a class="header-anchor" href="#三、ajax原理" aria-hidden="true">#</a> 三、AJAX原理</h1><h2 id="xmlhttprequest" tabindex="-1"><a class="header-anchor" href="#xmlhttprequest" aria-hidden="true">#</a> XMLHttpRequest</h2><p><code>XMLHttpRequet</code>，简称 <code>XHR</code>，可以用于与服务器交互。</p><p><code>XHR</code> 是在 <code>axios</code> 里面的，有的时候一些静态网页并不需要那么大的代码量，发送的请求只有一两次的话，就可以直接使用 <code>XHR</code>，两三行代码就可以搞定了。</p><h3 id="步骤" tabindex="-1"><a class="header-anchor" href="#步骤" aria-hidden="true">#</a> 步骤</h3><ol><li>创建 <code>XMLHttpRequest</code> 对象</li><li>配置请求方法和请求 <code>url</code> 地址</li><li>监听 <code>loadend</code> 事件，接收响应结果</li><li>发起请求</li></ol><h3 id="语法" tabindex="-1"><a class="header-anchor" href="#语法" aria-hidden="true">#</a> 语法</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;请求方法&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;请求url网址&#39;</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;loadend&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例：</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-p<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;http://hmajax.itheima.net/api/province&#39;</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;loadend&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log(xhr.response);</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span>
      <span class="token comment">// console.log(data.list.join(&#39;&lt;br&gt;&#39;));</span>
      document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.my-p&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> data<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;br&gt;&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xmlhttprequest-查询参数" tabindex="-1"><a class="header-anchor" href="#xmlhttprequest-查询参数" aria-hidden="true">#</a> XMLHttpRequest - 查询参数</h3><h4 id="语法-1" tabindex="-1"><a class="header-anchor" href="#语法-1" aria-hidden="true">#</a> 语法</h4><p><code>http://xxxx.com/xxx/xxx?参数名1=值1&amp;参数名2=值2</code></p><h4 id="小案例-地区查询" tabindex="-1"><a class="header-anchor" href="#小案例-地区查询" aria-hidden="true">#</a> 小案例 - 地区查询</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> selBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.sel-btn&#39;</span><span class="token punctuation">)</span>
selBtn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> pname <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.province&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
  <span class="token keyword">const</span> cname <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.city&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
  
  <span class="token keyword">const</span> qObj <span class="token operator">=</span> <span class="token punctuation">{</span>
    pname<span class="token punctuation">,</span>
    cname
  <span class="token punctuation">}</span>
  
  <span class="token keyword">const</span> paramsObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>qObj<span class="token punctuation">)</span>
  <span class="token keyword">const</span> queryString <span class="token operator">=</span> paramsObj<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
  <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">http://hmajax.itheima.net/api/area?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>queryString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;loadend&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span>
    <span class="token keyword">const</span> htmlStr <span class="token operator">=</span> data<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">areaName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;li class=&quot;list-group-item&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>areaName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li&gt;</span><span class="token template-punctuation string">\`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.list-group&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> htmlStr
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xmlhttprequest-数据提交" tabindex="-1"><a class="header-anchor" href="#xmlhttprequest-数据提交" aria-hidden="true">#</a> XMLHttpRequest - 数据提交</h3><blockquote><p>请求头设置 Content-Type: application/json</p><p>请求体携带 JSON 字符串</p></blockquote><h4 id="语法-2" tabindex="-1"><a class="header-anchor" href="#语法-2" aria-hidden="true">#</a> 语法</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;请求方法&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;请求url网址&#39;</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;loadend&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&#39;itheima007&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;7654321&#39;</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> userStr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>userStr<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例：</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>reg-btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>注册用户<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.reg-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;http://hmajax.itheima.net/api/register&#39;</span><span class="token punctuation">)</span>
      xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;loadend&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> userObj <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&#39;itheima832&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;7654321&#39;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> userStr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>userObj<span class="token punctuation">)</span>
      xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>userStr<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+p+`" alt="image-20231219101730130" loading="lazy"></p><h2 id="promise" tabindex="-1"><a class="header-anchor" href="#promise" aria-hidden="true">#</a> Promise</h2><p>管理异步操作的代码，获取异步操作成功或者失败的结果。</p><h3 id="步骤-1" tabindex="-1"><a class="header-anchor" href="#步骤-1" aria-hidden="true">#</a> 步骤</h3><ol><li>创建 Promise 对象</li><li>执行异步任务并传递结果 <ol><li>成功调用：resolve（值）触发then() 执行</li><li>失败调用：reject（值）触发 catch() 执行</li></ol></li><li>接收结果</li></ol><h3 id="语法-3" tabindex="-1"><a class="header-anchor" href="#语法-3" aria-hidden="true">#</a> 语法</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 执行异步任务并传递结果</span>
	<span class="token comment">// 1. 成功调用：resolve（值）触发then() 执行</span>
	<span class="token comment">// 2. 失败调用：reject（值）触发 catch() 执行</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 成功</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 失败</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// resolve(&#39;模拟成功结果&#39;)</span>
    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;模拟失败结果&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="promise-三种状态" tabindex="-1"><a class="header-anchor" href="#promise-三种状态" aria-hidden="true">#</a> Promise - 三种状态</h3><p>一个 Promise 对象，必然处于以下几种状态之一</p><ul><li>待定 (pending)：初始状态，既没有被兑现，也没有被拒绝</li><li>已兑现(fulfilled)：意味着，操作成功完成</li><li>已拒绝(rejected)：意味着，操作失败</li></ul><p><img src="`+e+`" alt="image-20231219103451184" loading="lazy"></p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>Promise 对象一旦被兑现 / 拒绝就是已敲定了，状态无法再被改变</p></div><h2 id="封装简易版-axios" tabindex="-1"><a class="header-anchor" href="#封装简易版-axios" aria-hidden="true">#</a> 封装简易版 axios</h2><h3 id="需求" tabindex="-1"><a class="header-anchor" href="#需求" aria-hidden="true">#</a> 需求</h3><p>基于 Promise + XHR 封装 myAxios 函数，获取省份列表展示</p><h3 id="步骤-2" tabindex="-1"><a class="header-anchor" href="#步骤-2" aria-hidden="true">#</a> 步骤</h3><ol><li>定义 myAxios 函数，接收配置对象，返回 Promise 对象</li><li>发起 XHR 请求，默认请求方法位 GET</li><li>调用成功/失败的处理程序</li><li>使用 myAxios 函数，获取省份列表展示</li></ol><h3 id="语法-4" tabindex="-1"><a class="header-anchor" href="#语法-4" aria-hidden="true">#</a> 语法</h3><h4 id="简易版" tabindex="-1"><a class="header-anchor" href="#简易版" aria-hidden="true">#</a> 简易版</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">myAxios</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> rej</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// XHR 请求</span>
    <span class="token comment">// 调用成功/失败的处理程序</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">myAxios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;目标资源地址&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="较完整版" tabindex="-1"><a class="header-anchor" href="#较完整版" aria-hidden="true">#</a> 较完整版</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">myAxios</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> paramsObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>params<span class="token punctuation">)</span>
      <span class="token keyword">const</span> queryString <span class="token operator">=</span> paramsObj<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      config<span class="token punctuation">.</span>url <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>queryString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>method <span class="token operator">||</span> <span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>url<span class="token punctuation">)</span>

    xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;loadend&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> jsonStr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
      xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">)</span>
      xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">myAxios</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> rej</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>method <span class="token operator">||</span> <span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;loadend&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">res</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">rej</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="案例-天气预报" tabindex="-1"><a class="header-anchor" href="#案例-天气预报" aria-hidden="true">#</a> 案例 - 天气预报</h2><h3 id="步骤-3" tabindex="-1"><a class="header-anchor" href="#步骤-3" aria-hidden="true">#</a> 步骤</h3><ol><li>默认显示-北京市天气 <ol><li>获取北京市天气数据</li><li>数据展示到页面</li></ol></li><li>搜索城市列表 <ol><li>绑定 input 事件，获取关键字</li><li>获取展示城市列表数据</li></ol></li><li>切换城市的天气 <ol><li>绑定城市点击事件，获取城市code值</li><li>调用获取并显示天气的函数</li></ol></li></ol><h3 id="代码实现" tabindex="-1"><a class="header-anchor" href="#代码实现" aria-hidden="true">#</a> 代码实现</h3><ol><li>默认显示 - 北京市天气</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getWeather</span><span class="token punctuation">(</span><span class="token parameter">cityCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">myAxios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://hmajax.itheima.net/api/weather&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">city</span><span class="token operator">:</span> cityCode
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(res);</span>
    <span class="token keyword">const</span> wObj <span class="token operator">=</span> res<span class="token punctuation">.</span>data
    <span class="token comment">// 阳历和农历日期</span>
    <span class="token keyword">const</span> dateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
      &lt;span class=&quot;dateShort&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
      &lt;span class=&quot;calendar&quot;&gt;农历&amp;nbsp;
        &lt;span class=&quot;dateLunar&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>dateLunar<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
      &lt;/span&gt;
    </span><span class="token template-punctuation string">\`</span></span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.title&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> dateStr
    <span class="token comment">// 城市名字</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> wObj<span class="token punctuation">.</span>area
    <span class="token comment">// 当天气温</span>
    <span class="token keyword">const</span> nowWStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
      &lt;div class=&quot;tem-box&quot;&gt;
        &lt;span class=&quot;temp&quot;&gt;
          &lt;span class=&quot;temperature&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>temperature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;span&gt;°&lt;/span&gt;
        &lt;/span&gt;
      &lt;/div&gt;
      &lt;div class=&quot;climate-box&quot;&gt;
        &lt;div class=&quot;air&quot;&gt;
          &lt;span class=&quot;psPm25&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>psPm25<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;span class=&quot;psPm25Level&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>psPm25Level<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
        &lt;/div&gt;
        &lt;ul class=&quot;weather-list&quot;&gt;
          &lt;li&gt;
            &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>weatherImg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; class=&quot;weatherImg&quot; alt=&quot;&quot;&gt;
            &lt;span class=&quot;weather&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>weather<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;/li&gt;
          &lt;li class=&quot;windDirection&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>windDirection<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li&gt;
          &lt;li class=&quot;windPower&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>windPower<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
    </span><span class="token template-punctuation string">\`</span></span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.weather-box&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> nowWStr
    <span class="token comment">// 当天天气</span>
    <span class="token keyword">const</span> twObj <span class="token operator">=</span> wObj<span class="token punctuation">.</span>todayWeather
    <span class="token keyword">const</span> todayWStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
      &lt;div class=&quot;range-box&quot;&gt;
          &lt;span&gt;今天：&lt;/span&gt;
          &lt;span class=&quot;range&quot;&gt;
            &lt;span class=&quot;weather&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>wObj<span class="token punctuation">.</span>weather<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
            &lt;span class=&quot;temNight&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>twObj<span class="token punctuation">.</span>temNight<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
            &lt;span&gt;-&lt;/span&gt;
            &lt;span class=&quot;temDay&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>twObj<span class="token punctuation">.</span>temDay<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
            &lt;span&gt;℃&lt;/span&gt;
          &lt;/span&gt;
        &lt;/div&gt;
        &lt;ul class=&quot;sun-list&quot;&gt;
          &lt;li&gt;
            &lt;span&gt;紫外线&lt;/span&gt;
            &lt;span class=&quot;ultraviolet&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>twObj<span class="token punctuation">.</span>ultraviolet<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;span&gt;湿度&lt;/span&gt;
            &lt;span class=&quot;humidity&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>twObj<span class="token punctuation">.</span>humidity<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;%
          &lt;/li&gt;
          &lt;li&gt;
            &lt;span&gt;日出&lt;/span&gt;
            &lt;span class=&quot;sunriseTime&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>twObj<span class="token punctuation">.</span>sunriseTime<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;span&gt;日落&lt;/span&gt;
            &lt;span class=&quot;sunsetTime&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>twObj<span class="token punctuation">.</span>sunsetTime<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
    </span><span class="token template-punctuation string">\`</span></span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.today-weather&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> todayWStr
    <span class="token comment">// 7日天气预报数据显示</span>
    <span class="token keyword">const</span> dayForecast <span class="token operator">=</span> wObj<span class="token punctuation">.</span>dayForecast
    <span class="token keyword">const</span> dayForecastStr <span class="token operator">=</span> dayForecast<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
        &lt;li class=&quot;item&quot;&gt;
          &lt;div class=&quot;date-box&quot;&gt;
            &lt;span class=&quot;dateFormat&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>dateFormat<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
            &lt;span class=&quot;date&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;/div&gt;
          &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>weatherImg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;&quot; class=&quot;weatherImg&quot;&gt;
          &lt;span class=&quot;weather&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>weather<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;div class=&quot;temp&quot;&gt;
            &lt;span class=&quot;temNight&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>temNight<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;-
            &lt;span class=&quot;temDay&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>temDay<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
            &lt;span&gt;℃&lt;/span&gt;
          &lt;/div&gt;
          &lt;div class=&quot;wind&quot;&gt;
            &lt;span class=&quot;windDirection&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>windDirection<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
            &lt;span class=&quot;windPower&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>windPower<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
          &lt;/div&gt;
        &lt;/li&gt;
      </span><span class="token template-punctuation string">\`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.week-wrap&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> dayForecastStr
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">getWeather</span><span class="token punctuation">(</span><span class="token string">&#39;110100&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+o+`" alt="image-20231219120133869" loading="lazy"></p><ol start="2"><li>搜索城市列表</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.search-city&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(e.target.value);</span>
  <span class="token function">myAxios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://hmajax.itheima.net/api/weather/city&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">city</span><span class="token operator">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> liStr <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;li class=&quot;city-item&quot; data-code=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li&gt;</span><span class="token template-punctuation string">\`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.search-list&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> liStr
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+c+`" alt="image-20231219121318664" loading="lazy"></p><ol start="3"><li>切换城市天气</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.search-list&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&#39;city-item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cityCode <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>code
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cityCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getWeather</span><span class="token punctuation">(</span>cityCode<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+i+'" alt="image-20231219144807181" loading="lazy"></p>',60),r=[u];function k(d,v){return s(),a("div",null,r)}const b=n(l,[["render",k],["__file","三、AJAX原理.html.vue"]]);export{b as default};
